<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="javafx_demo.controller.MainController"
            prefHeight="800.0" prefWidth="1400.0"
            style="-fx-background-color: #f5f5f5;">

    <!-- Top: Header Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="15.0"
              style="-fx-background-color: #2c3e50; -fx-padding: 12 15;">
            <Label text="打手终端" style="-fx-text-fill: white; -fx-font-weight: bold;">
                <font><Font size="18.0"/></font>
            </Label>
            <Region HBox.hgrow="ALWAYS"/>
            <!-- 快捷操作 -->
            <Button fx:id="acceptOrderBtn" text="接单" onAction="#handleAcceptOrder"
                    style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-cursor: hand; -fx-background-radius: 5; -fx-padding: 8 18;">
                <font><Font size="13.0"/></font>
            </Button>
            <Button fx:id="findingRequestBtn" text="创建找单请求" onAction="#handleFindingRequest"
                    style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-cursor: hand; -fx-background-radius: 5; -fx-padding: 8 18;">
                <font><Font size="13.0"/></font>
            </Button>
            <Button fx:id="offlineBtn" text="离线" onAction="#handleOffline"
                    style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-cursor: hand; -fx-background-radius: 5; -fx-padding: 8 18;">
                <font><Font size="13.0"/></font>
            </Button>
            <Separator orientation="VERTICAL" style="-fx-padding: 0 5;"/>
            <Label fx:id="usernameLabel" text="用户名" style="-fx-text-fill: white;">
                <font><Font size="14.0"/></font>
            </Label>
            <Button fx:id="logoutButton" text="退出" onAction="#handleLogout"
                    style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-cursor: hand; -fx-background-radius: 5; -fx-padding: 8 15;">
                <font><Font size="12.0"/></font>
            </Button>
        </HBox>
    </top>

    <!-- Left: Navigation Menu -->
    <left>
        <VBox spacing="5.0" style="-fx-background-color: white; -fx-padding: 10;" prefWidth="180.0">
            <Label text="导航菜单" style="-fx-font-weight: bold; -fx-padding: 10 0 10 10;">
                <font><Font size="14.0"/></font>
            </Label>
            <Separator/>
            <Button fx:id="dashboardBtn" text="工单列表" onAction="#showDashboard" maxWidth="Infinity"
                    style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-cursor: hand; -fx-alignment: CENTER_LEFT; -fx-padding: 10;">
                <font><Font size="13.0"/></font>
            </Button>
            <Button fx:id="dataManageBtn" text="统计" onAction="#showStatistics" maxWidth="Infinity"
                    style="-fx-background-color: transparent; -fx-text-fill: #2c3e50; -fx-cursor: hand; -fx-alignment: CENTER_LEFT; -fx-padding: 10;">
                <font><Font size="13.0"/></font>
            </Button>
            <Button fx:id="settingsBtn" text="设置" onAction="#showSettings" maxWidth="Infinity"
                    style="-fx-background-color: transparent; -fx-text-fill: #2c3e50; -fx-cursor: hand; -fx-alignment: CENTER_LEFT; -fx-padding: 10;">
                <font><Font size="13.0"/></font>
            </Button>
        </VBox>
    </left>

    <!-- Center: StackPane (多视图切换，解决跳转 bug) -->
    <center>
        <StackPane fx:id="contentStack" style="-fx-background-color: white;">

            <!-- 视图 1: 工单列表 -->
            <VBox fx:id="orderPane" spacing="10.0" style="-fx-padding: 15;">
                <HBox alignment="CENTER_LEFT" spacing="10.0">
                    <Label text="今日工单" style="-fx-font-weight: bold; -fx-font-size: 16;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Button fx:id="refreshBtn" text="刷新" onAction="#handleRefresh"
                            style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-cursor: hand; -fx-background-radius: 5; -fx-padding: 6 15;"/>
                </HBox>
                <TableView fx:id="ordersTable" VBox.vgrow="ALWAYS"
                           style="-fx-background-color: white; -fx-border-color: #ddd; -fx-border-radius: 5;">
                    <columns>
                        <TableColumn fx:id="idCol" text="工单ID" prefWidth="130" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="typeCol" text="类型" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="customerCol" text="客户" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="statusCol" text="状态" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="amountCol" text="数量" prefWidth="80" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="unitCol" text="单位" prefWidth="60" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="incomeCol" text="结算价" prefWidth="80" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="issueDateCol" text="创建时间" prefWidth="150" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="actionCol" text="操作" prefWidth="220" style="-fx-alignment: CENTER;"/>
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                    </columnResizePolicy>
                </TableView>
            </VBox>

            <!-- 视图 2: 统计 -->
            <VBox fx:id="statsPane" spacing="20.0" alignment="CENTER" visible="false"
                  style="-fx-padding: 40;">
                <Label text="我的统计" style="-fx-font-weight: bold; -fx-font-size: 20;"/>
                <HBox alignment="CENTER" spacing="60.0">
                    <VBox alignment="CENTER" spacing="8.0"
                          style="-fx-background-color: #ebf5fb; -fx-padding: 30; -fx-background-radius: 10;">
                        <Label text="总工单数" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14;"/>
                        <Label fx:id="totalOrdersLabel" text="--"
                               style="-fx-text-fill: #2c3e50; -fx-font-weight: bold; -fx-font-size: 36;"/>
                    </VBox>
                    <VBox alignment="CENTER" spacing="8.0"
                          style="-fx-background-color: #eafaf1; -fx-padding: 30; -fx-background-radius: 10;">
                        <Label text="总收入" style="-fx-text-fill: #7f8c8d; -fx-font-size: 14;"/>
                        <Label fx:id="totalIncomeLabel" text="--"
                               style="-fx-text-fill: #27ae60; -fx-font-weight: bold; -fx-font-size: 36;"/>
                    </VBox>
                </HBox>
            </VBox>

            <!-- 视图 3: 设置(占位) -->
            <VBox fx:id="settingsPane" spacing="15.0" alignment="CENTER" visible="false"
                  style="-fx-padding: 40;">
                <Label text="设置" style="-fx-font-weight: bold; -fx-font-size: 20;"/>
                <Label text="设置功能开发中..." style="-fx-text-fill: #95a5a6; -fx-font-size: 14;"/>
            </VBox>

        </StackPane>
    </center>

    <!-- Bottom: Status Bar -->
    <bottom>
        <HBox alignment="CENTER_LEFT" spacing="10.0"
              style="-fx-background-color: #ecf0f1; -fx-padding: 8;">
            <Label fx:id="statusLabel" text="就绪" style="-fx-text-fill: #7f8c8d;">
                <font><Font size="12.0"/></font>
            </Label>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="versionLabel" text="Version 1.0.0" style="-fx-text-fill: #95a5a6;">
                <font><Font size="12.0"/></font>
            </Label>
        </HBox>
    </bottom>

</BorderPane>
